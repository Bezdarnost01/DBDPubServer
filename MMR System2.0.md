# **1. Входные данные**

* Для **каждого выжившего** и **киллера** после матча известны 4 эмблемы, каждая — на уровне:

  * Бронза (Bronze)
  * Серебро (Silver)
  * Золото (Gold)
  * Радужная (Iridescent)
* Известен итог матча:

  * TEAM\_RESULT:

    * 1  — Победа выживших (выживших сбежало больше половины)
    * 0  — Ничья (2 сбежали, 2 умерли)
    * -1 — Победа киллера (умерли минимум 3)

---

# **2. Преобразование эмблем**

* Для расчёта присваиваем значения:

  * Bronze      = **0.25**
  * Silver      = **0.5**
  * Gold        = **0.75**
  * Iridescent  = **1.0**
* Это делается для каждой из 4 эмблем у каждого игрока (и у киллера).

---

# **3. Индивидуальный вклад**

* Для каждого игрока (и киллера) считаем массив из четырёх чисел: `[эмблема1, эмблема2, эмблема3, эмблема4]`
* Выделяем **максимум** из этих четырёх: это главная твоя “сильная сторона” матча.
* Проверяем “мультироль”: если у тебя есть хотя бы **2 эмблемы ≥ 0.7** (например, Gold+ или Iridescent), ты получаешь дополнительный бонус (например, +0.15).

---

# **4. Финальная формула**

Для каждого игрока и киллера:

```
MMR_delta = max(Э1, Э2, Э3, Э4)
            + 0.15 * (есть ли мультироль)
            + 0.2 * (TEAM_RESULT)     # для киллера знак инвертируем!
```

* (все коэффициенты настраиваются, можно под себя)
* Результат умножаем на масштабный коэффициент (например, ×50), чтобы было "ощутимо".

---

# **5. Киллер — отличие**

* Для киллера при расчёте всегда **TEAM\_RESULT = -TEAM\_RESULT\_выживших** (то есть если победили сурвы, для киллера это -1).

---

# **6. Пример среднего матча**

### Допустим:

* **TEAM\_RESULT = 0** (ничья: сбежало 2 сурва, 2 умерли)
* Уровни эмблем у игроков и киллера:

|    | OBJ    | CHASE  | ALTR   | SURV   |
| -- | ------ | ------ | ------ | ------ |
| S1 | Gold   | Silver | Silver | Gold   |
| S2 | Silver | Bronze | Silver | Silver |
| S3 | Gold   | Gold   | Gold   | Silver |
| S4 | Silver | Silver | Silver | Bronze |

|    | Gatekeeper | Devout | Malicious | Chaser |
| -- | ---------- | ------ | --------- | ------ |
| K1 | Gold       | Gold   | Silver    | Gold   |

---

Теперь переведём в числа:

* Gold = 0.75
* Silver = 0.5
* Bronze = 0.25

---

|    | Э1   | Э2   | Э3   | Э4   | max  | мультироль?  |
| -- | ---- | ---- | ---- | ---- | ---- | ------------ |
| S1 | 0.75 | 0.5  | 0.5  | 0.75 | 0.75 | Да (2x 0.75) |
| S2 | 0.5  | 0.25 | 0.5  | 0.5  | 0.5  | Нет          |
| S3 | 0.75 | 0.75 | 0.75 | 0.5  | 0.75 | Да (3x 0.75) |
| S4 | 0.5  | 0.5  | 0.5  | 0.25 | 0.5  | Нет          |
| K1 | 0.75 | 0.75 | 0.5  | 0.75 | 0.75 | Да (3x 0.75) |

---

### Расчёт по формуле

MMR\_delta = max + (0.15 если мультироль) + (0.2 \* TEAM\_RESULT), \*50

#### Для сурвов:

* **S1:** 0.75 + 0.15 + (0.2\*0) = 0.90 × 50 = **+45**
* **S2:** 0.5  + 0    + 0        = 0.5 × 50  = **+25**
* **S3:** 0.75 + 0.15 + 0        = 0.90 × 50 = **+45**
* **S4:** 0.5  + 0    + 0        = 0.5 × 50  = **+25**

#### Для киллера:

* Для киллера TEAM\_RESULT = -0 = 0
* **K1:** 0.75 + 0.15 + 0 = 0.90 × 50 = **+45**

---

* Сурвы и киллер, у кого несколько “хороших” эмблем — получили максимум.
* Остальные — в среднем диапазоне.
* За ничью бонус/штраф по команде отсутствует.
* Если бы команда выиграла/проиграла, было бы ±10 за команду.
